<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Update Blog</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            display: flex;
        }
        .sidebar {
            width: 200px;
            background-color: #2c3e50;
            color: white;
            display: flex;
            flex-direction: column;
            padding: 10px;
        }
        .sidebar button {
            font-size: 16px; /* Set a consistent font size */
            background: none;
            border: none;
            color: white;
            padding: 10px;
            text-align: left;
            width: 100%;
            cursor: pointer;
            border-bottom: 1px solid #34495e;
        }
        .sidebar button:hover {
            background-color: #34495e;
        }
        .content {
            margin:0px 220px; /* Adjust to match sidebar width */
            padding: 20px;
            flex: 1;
        }
        h1 {
            margin-bottom: 20px;
        }
        form label {
            display: block;
            margin-top: 10px;
            font-weight: bold;
        }
        form input, form textarea, form button {
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        form button {
            background-color: #4CAF50;
            color: white;
            cursor: pointer;
        }
        form button:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <button onclick="window.location.href='createBlog.html'">Create Blog</button>
        <button onclick="window.location.href='updateBlog.html'">Update Blog</button>
        <button onclick="window.location.href='deleteBlog.html'">Delete Blog</button>
        <hr>
        <button onclick="window.location.href='createTrip.html'">Create Trip</button>
        <button onclick="window.location.href='updateTrip.html'">Update Trip</button>
        <button onclick="window.location.href='deleteTrip.html'">Delete Trip</button>
        <hr>
        <button onclick="window.location.href='addBooking.html'">Trip dates Management</button>
    </div>

    <!-- Admin Dashboard Section -->
    <div class="content">

        <h1 class="mt-5">Add New Trip</h1>

        <form id="tripForm" action="/add-trip" method="POST" enctype="multipart/form-data">
            <div class="form-group">
                <label for="title">Trip Title</label>
                <input type="text" class="form-control" id="title" name="title" required>
            </div>
        
            <div class="form-group">
                <label for="subtitle">Subtitle</label>
                <input type="text" class="form-control" id="subtitle" name="subtitle">
            </div>
        
            <div class="form-group">
                <label for="description">Description</label>
                <textarea class="form-control" id="description" name="description" rows="4" required></textarea>
            </div>
        
            <div class="form-group">
                <label for="price">Price</label>
                <input type="number" class="form-control" id="price" name="price" required>
            </div>
        
            <div class="form-group">
                <label for="tripType">Trip Type</label>
                <select class="form-control" id="tripType" name="tripType" required>
                    <option value="adventure">Adventure</option>
                    <option value="culture">Culture</option>
                    <option value="trekking">Trekking</option>
                </select>
            </div>
        
            <div class="form-group">
                <label for="activityLevel">Activity Level</label>
                <select class="form-control" id="activityLevel" name="activityLevel" required>
                    <option value="high">High</option>
                    <option value="medium">Medium</option>
                    <option value="low">Low</option>
                </select>
            </div>
        
            <div class="form-group">
                <label for="area">Area</label>
                <select class="form-control" id="area" name="area" required>
                    <option value="Balochistan">Balochistan</option>
                    <option value="Chitral">Chitral</option>
                    <option value="Gilgit Baltistan">Gilgit Baltistan</option>
                    <option value="Hunza">Hunza</option>
                    <option value="Islamabad">Islamabad</option>
                    <option value="Karachi">Karachi</option>
                    <option value="Kartarpur">Kartarpur</option>
                    <option value="Kashmir">Kashmir</option>
                    <option value="Northern Pakistan">Northern Pakistan</option>
                </select>
            </div>
        
            <div class="form-group">
                <label for="image">Primary Image URL</label>
                <input type="text" class="form-control" id="image" name="image" required>
            </div>
        
            <div class="form-group">
                <label for="image1">Additional Image 1 URL</label>
                <input type="text" class="form-control" id="image1" name="image1">
            </div>
        
            <div class="form-group">
                <label for="image2">Additional Image 2 URL</label>
                <input type="text" class="form-control" id="image2" name="image2">
            </div>
        
            <div class="form-group">
                <label for="image3">Additional Image 3 URL</label>
                <input type="text" class="form-control" id="image3" name="image3">
            </div>
        
            <div class="form-group">
                <label for="introduction">Introduction</label>
                <textarea class="form-control" id="introduction" name="introduction" rows="3"></textarea>
            </div>
            
            <div class="form-group">
                <label for="departure">Departure</label>
                <input type="text" class="form-control" id="departure" name="departure">
            </div>
            
            <div class="form-group">    
                <label for="fitnessLevel">Fitness Level</label>
                <input type="text" class="form-control" id="fitnessLevel" name="fitnessLevel">
            </div>
            
            <div class="form-group">
                <label for="expeditionType">Expedition Type</label>
                <input type="text" class="form-control" id="expeditionType" name="expeditionType">
            </div>

            <div class="form-group">
                <label for="highlights">Highlights</label>
                <input type="text" class="form-control" id="highlight1" name="highlight1" placeholder="Highlight 1">
                <input type="text" class="form-control" id="highlight2" name="highlight2" placeholder="Highlight 2">
                <input type="text" class="form-control" id="highlight3" name="highlight3" placeholder="Highlight 3">
                <input type="text" class="form-control" id="highlight4" name="highlight4" placeholder="Highlight 4">
            </div>
        
            <div class="form-group">
                <label for="map1">Map Image URL</label>
                <input type="text" class="form-control" id="map1" name="map1">
            </div>
        
            <div class="form-group">
                <label for="duration">Duration (in days)</label>
                <input type="number" class="form-control" id="duration" name="duration" required>
            </div>
        
            <div class="form-group">
                <label for="itineraryDays">Itinerary Days</label>
                <input type="number" class="form-control" id="itineraryDays" name="itineraryDays">
            </div>
        
            <div id="itineraryContainer">
                <h4>Itinerary</h4>
                <button type="button" id="addItineraryDay">Add Day</button>
                <!-- JavaScript will dynamically add fields here -->
            </div>
        
            <div class="form-group">
                <label for="meals">Meals</label>
                <input type="text" class="form-control" id="meals" name="meals">
            </div>
        
            <div class="form-group">
                <label for="accommodation">Accommodation</label>
                <input type="text" class="form-control" id="accommodation" name="accommodation">
            </div>
        
            <div class="form-group">
                <label for="transport">Transport</label>
                <input type="text" class="form-control" id="transport" name="transport">
            </div>
        
            <div class="form-group">
                <label for="visaApplication">Visa Application Details</label>
                <textarea class="form-control" id="visaApplication" name="visaApplication" rows="3"></textarea>
            </div>
        
            <div class="form-group">
                <label for="servicesNotIncluded">Services Not Included</label>
                <input type="text" class="form-control" id="notIncluded1" name="notIncluded1" placeholder="Meals">
                <input type="text" class="form-control" id="notIncluded2" name="notIncluded2" placeholder="Accommodation">
                <input type="text" class="form-control" id="notIncluded3" name="notIncluded3" placeholder="Transport">
                <input type="text" class="form-control" id="notIncluded4" name="notIncluded4" placeholder="Visa">
                <input type="text" class="form-control" id="notIncluded5" name="notIncluded5" placeholder="Tips">
            </div>
            
        
            <div class="form-group">
                <label for="whoCanJoinUs">Who Can Join Us?</label>
                <textarea class="form-control" id="whoCanJoinUs" name="whoCanJoinUs" rows="3"></textarea>
            </div>
        
            <div class="form-group">
                <label for="clothing">Clothing</label>
                <textarea class="form-control" id="clothing" name="clothing" rows="3"></textarea>
            </div>
        
            <div class="form-group">
                <label for="gear">Gear</label>
                <textarea class="form-control" id="gear" name="gear" rows="3"></textarea>
            </div>
        
            <div class="form-group">
                <label for="personalItems">Personal Items</label>
                <textarea class="form-control" id="personalItems" name="personalItems" rows="3"></textarea>
            </div>
        
            <div class="form-group">
                <label for="miscellaneous">Miscellaneous</label>
                <textarea class="form-control" id="miscellaneous" name="miscellaneous" rows="3"></textarea>
            </div>
        
            <div class="form-group">
                <label for="optionalExtras">Optional Extras</label>
                <textarea class="form-control" id="optionalExtras" name="optionalExtras" rows="3"></textarea>
            </div>
        
            <div class="form-group">
                <label for="category">Category</label>
                <select class="form-control" id="category" name="category" required>
                    <option value="alpine adventures">Alpine Adventures</option>
                    <option value="leisurely thrills">Leisurely Thrills</option>
                    <option value="culture and heritage expeditions">Culture & Heritage Expeditions</option>
                    <option value="seasonal splendors">Seasonal Splendors</option>
                    <option value="exclusive interest tours">Exclusive Interest Tours</option>
                    <option value="wellness excursion">Wellness Excursion</option>
                </select>
            </div>
        
            <button type="submit" class="btn btn-primary">Add Trip</button>
        </form>
        


        
    </div>
    

    <script>
        // Fetch the form data and post it to the server
        document.getElementById('tripForm').addEventListener('submit', async (e) => {
            e.preventDefault(); // Prevent the default form submission
    
            // Get the form values
            const tripData = {
                title: document.getElementById('title').value,
                description: document.getElementById('description').value,
                price: Number(document.getElementById('price').value),
                tripType: document.getElementById('tripType').value,
                activityLevel: document.getElementById('activityLevel').value,
                area: document.getElementById('area').value,
                image: document.getElementById('image').value,
                duration: Number(document.getElementById('duration').value),
                category: document.getElementById('category').value,
                subtitle: document.getElementById('subtitle')?.value || '',
                departure: document.getElementById('departure')?.value || '',
                fitnessLevel: document.getElementById('fitnessLevel')?.value || '',
                expeditionType: document.getElementById('expeditionType')?.value || '',
                meals: document.getElementById('meals')?.value || '',
                accommodation: document.getElementById('accommodation')?.value || '',
                transport: document.getElementById('transport')?.value || '',
                visaApplication: document.getElementById('visaApplication')?.value || '',
                extras: document.getElementById('extras')?.value || '',
                whoCanJoinUs: document.getElementById('whoCanJoinUs')?.value || '',
                clothing: document.getElementById('clothing')?.value || '',
                gear: document.getElementById('gear')?.value || '',
                personalItems: document.getElementById('personalItems')?.value || '',
                miscellaneous: document.getElementById('miscellaneous')?.value || '',
                optionalExtras: document.getElementById('optionalExtras')?.value || '',
                servicesNotIncluded: {
                    meals: document.getElementById('notIncluded1').value || '',
                    accommodation: document.getElementById('notIncluded2').value || '',
                    transport: document.getElementById('notIncluded3').value || '',
                    visa: document.getElementById('notIncluded4').value || '',
                    tips: document.getElementById('notIncluded5').value || ''
                },
                itinerary: Array.from(document.querySelectorAll('.itinerary-day')).map(el => ({
                    day: Number(el.querySelector('.day').value),
                    heading: el.querySelector('.heading').value,
                    text: el.querySelector('.text').value,
                })),
                highlights: {
                    highlight1: document.getElementById('highlight1')?.value || '',
                    highlight2: document.getElementById('highlight2')?.value || '',
                    highlight3: document.getElementById('highlight3')?.value || '',
                    highlight4: document.getElementById('highlight4')?.value || '',
                },
                images: {
                    image1: document.getElementById('image1')?.value || '',
                    image2: document.getElementById('image2')?.value || '',
                    image3: document.getElementById('image3')?.value || '',
                },
                map1: document.getElementById('map1')?.value || '',
                itineraryDays: Number(document.getElementById('itineraryDays')?.value) || 0,
            };
    
            try {
                // Send the trip data to the server via POST
                const response = await fetch('http://localhost:5000/api/trips', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(tripData), // Convert the data to JSON
                    
                });
                console.log("hello");
                // Check if the response was successful
                if (response.ok) {
                    alert('Trip added successfully!');
                    // Optionally, you can reset the form or redirect the user
                    document.getElementById('tripForm').reset();
                } else {
                    const errorMsg = await response.text();
                    alert(`Failed to add trip. Error: ${errorMsg}`);
                }
            } catch (error) {
                console.error('Error:', error);
                alert('Error occurred. Please try again.');
            }
            
        });

        document.getElementById('addItineraryDay').addEventListener('click', function() {
            const itineraryContainer = document.getElementById('itineraryContainer');

            // Create a new div for the itinerary day
            const newDayDiv = document.createElement('div');
            newDayDiv.classList.add('itinerary-day');

            // Add Day Input
            const dayLabel = document.createElement('label');
            dayLabel.textContent = 'Day';
            const dayInput = document.createElement('input');
            dayInput.type = 'number';
            dayInput.classList.add('day');
            dayInput.name = 'day';

            // Add Heading Input
            const headingLabel = document.createElement('label');
            headingLabel.textContent = 'Heading';
            const headingInput = document.createElement('input');
            headingInput.type = 'text';
            headingInput.classList.add('heading');
            headingInput.name = 'heading';

            // Add Text Input
            const textLabel = document.createElement('label');
            textLabel.textContent = 'Text';
            const textInput = document.createElement('textarea');
            textInput.classList.add('text');
            textInput.name = 'text';

            // Append all fields to the newDayDiv
            newDayDiv.appendChild(dayLabel);
            newDayDiv.appendChild(dayInput);
            newDayDiv.appendChild(headingLabel);
            newDayDiv.appendChild(headingInput);
            newDayDiv.appendChild(textLabel);
            newDayDiv.appendChild(textInput);

            // Append the newDayDiv to the itinerary container
            itineraryContainer.appendChild(newDayDiv);
        });

        function getItineraryData() {
            const itineraryData = Array.from(document.querySelectorAll('.itinerary-day')).map(el => ({
                day: Number(el.querySelector('.day').value),
                heading: el.querySelector('.heading').value,
                text: el.querySelector('.text').value,
            }));
            return itineraryData;
        }

    </script>
    
    
</body>
</html>
